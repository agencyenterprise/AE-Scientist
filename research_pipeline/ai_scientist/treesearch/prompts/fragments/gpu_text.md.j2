{% set gpu = environment_context.get("gpu", {}) %}
{% set gpu_id = gpu.get("gpu_id") %}
{% set gpu_spec = gpu.get("gpu_spec") %}

{% if gpu_id is not none and gpu_spec is mapping %}
**Available Hardware**:
{% set name = gpu_spec.get("name", "GPU") %}
{% set mem = gpu_spec.get("memory_total_mib") %}
{% set mem_str = mem if mem is not none else "unknown" %}
- GPU: ONE {{ name }} with {{ mem_str }}MiB VRAM (assigned gpu_id={{ gpu_id }}).
- GPU selection: `CUDA_VISIBLE_DEVICES` is already set for this run; inside your process prefer `torch.device('cuda:0')`.
{% endif %}